%用切比雪夫最佳一致逼近设计线性相位FIR带通滤波器；
%信号为0.5hz, 0.9hz, 1.1hz和1.5hz的正统信号叠加组成
%通带为[0.9,1.1]
%频谱分辨率与信号实际长度N成正比
clear all;
f1=0.5;f2=0.9;f3=1.1;f4=1.5;t=0:1203;N=length(t);fs=10;M=512;
x1=sin(2*pi*(f1/fs)*t)+sin(2*pi*(f2/fs)*t)+sin(2*pi*(f3/fs)*t)+sin(2*pi*(f4/fs)*t);

dat=[[4912,4572,4576];[4984,4552,4520];[5032,4432,4516];[5040,4464,4520];[5068,4488,4516];[5056,4480,4480];[5044,4520,4488];[5088,4604,4512];[4972,4496,4476];[4896,4500,4416];[4932,4580,4404];[4908,4636,4396];[4856,4636,4360];[4792,4632,4312];[4812,4636,4304];[4864,4608,4356];[4876,4640,4364];[4888,4628,4376];[4984,4584,4352];[5060,4572,4372];[5108,4544,4448];[5148,4536,4448];[5144,4512,4468];[5208,4540,4492];[5148,4508,4548];[5160,4472,4536];[5056,4352,4524];[4956,4336,4472];[5096,4436,4500];[5104,4456,4624];[5084,4448,4680];[5156,4496,4624];[5192,4536,4608];[5152,4564,4612];[5132,4540,4552];[4980,4508,4496];[4868,4472,4408];[4820,4472,4372];[4780,4468,4372];[4848,4480,4332];[5012,4564,4408];[5032,4552,4504];[5004,4464,4452];[5052,4464,4440];[5144,4468,4436];[5168,4388,4504];[5132,4360,4456];[5060,4372,4380];[5092,4396,4372];[5108,4364,4392];[5116,4332,4396];[5136,4296,4396];[5124,4380,4424];[5116,4400,4436];[5076,4416,4480];[5184,4488,4524];[5240,4480,4524];[5032,4280,4448];[5124,4340,4456];[5392,4524,4588];[5420,4464,4652];[5268,4396,4648];[5228,4452,4648];[5168,4516,4552];[5048,4580,4440];[4824,4476,4464];[4728,4416,4416];[4732,4408,4368];[4776,4412,4324];[4916,4476,4400];[5064,4492,4444];[5020,4460,4440];[5096,4384,4364];[5248,4444,4380];[5396,4460,4528];[5364,4372,4548];[5196,4300,4432];[5164,4304,4356];[5132,4308,4368];[5196,4252,4376];[5164,4232,4368];[5180,4212,4368];[5276,4308,4384];[5296,4360,4456];[5336,4468,4620];[5440,4580,4524];[5084,4356,4464];[5160,4448,4512];[5328,4628,4500];[5288,4664,4720];[5112,4584,4672];[5004,4532,4592];[4932,4524,4472];[4808,4480,4416];[4764,4408,4392];[4744,4408,4352];[4860,4432,4360];[4984,4508,4368];[5148,4612,4404];[4992,4440,4440];[5080,4456,4404];[5228,4492,4356];[5268,4524,4460];[5224,4420,4500];[5124,4360,4436];[5116,4380,4360];[5116,4308,4412];[5132,4268,4436];[5164,4212,4432];[5296,4636,4484];[5264,4652,4704];[5108,4452,4408];[5256,4400,4448];[5224,4572,4532];[4876,4504,4452];[5176,4360,4492];[5052,4380,4340];[5048,4308,4440];[5272,4620,4564];[4896,4440,4416];[5056,4396,4320];[5072,4352,4356];[5204,4376,4408];[5216,4400,4464];[5248,4612,4488];[5084,4576,4376];[5236,4520,4644];[5232,4428,4648];[5184,4280,4632];[5052,4328,4520]];
x1=dat(:,1);
[N,col]=size(dat);
t=1:N;

figure(1);
subplot(211);
plot(t,x1);
title('原信号');

%处理前频谱
y=fft(x1);
f=(0:1/N:1/2-1/N)*fs;
subplot(212);
plot(f,abs(y(1:N/2)));
grid;
xlabel('hz');

wc1=2*f2/fs;
wc2=2*f3/fs;
wc3=2*f4/fs;%归一化角频率，用于下面的f1

f1=[0 wc1-0.05 wc1 wc2 wc2+0.05 1];
A=[0 0 1 1 0 0];%设置带通或带阻，1为带通，0为带阻	
weigh=[1 1 1 ];%设置通带和阻带的权重
b=remez(60,f1,A,weigh);%传函分子
h1=freqz(b,1,M);%幅频特性

figure(2)

f=(0:1/M:1-1/M)*fs/2;
subplot(211);
plot(f,abs(h1));
grid;
title('带通');


x2=filter(b,1,x1);
S1=fft(x2);
f=(0:1/N:1/2-1/N)*fs;
subplot(212);
plot(f,abs(S1(1:N/2)));
grid;
xlabel('hz');%处理后频谱